!function(t,e){"function"==typeof define&&define.amd?define(["React"],e):"object"==typeof exports?module.exports=e(require("react/addons")):t.ReactDrag=e(t.React)}(this,function(t){"use strict";function e(){for(var t="",n=0;n<arguments.length;n++){var s=arguments[n];if(s){var r=typeof s;if("string"===r||"number"===r)t+=" "+s;else if(Array.isArray(s))t+=" "+e.apply(null,s);else if("object"===r)for(var o in s)s.hasOwnProperty(o)&&s[o]&&(t+=" "+o)}}return t.substr(1)}function n(t){return{position:{top:t.state.clientY,left:t.state.clientX}}}function s(t){return"both"===t.props.axis||"y"===t.props.axis}function r(t){return"both"===t.props.axis||"x"===t.props.axis}function o(t){return"function"==typeof t||"[object Function]"===Object.prototype.toString.call(t)}function a(t,e){for(var n=0,s=t.length,r=null;s>n;n+=1)if(r=t[n],e.apply(e,[r,n,t]))return r}function i(t,e){var n=a(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(e){return o(t[e])});return t[n].call(t,e)}function h(t){var e=t.touches&&t.touches[0]||t;return{clientX:e.clientX,clientY:e.clientY}}function c(t,e,n,s){if(n){"string"!=typeof n&&"parent"!==n.toLowerCase()&&"object"!=typeof n&&console.warn('Bound should either "parent" or an object');var r=s.parentNode,o=n.top||0,a=n.left||0,i=n.right||r.offsetWidth,h=n.bottom||r.offsetHeight;t=Math.min(t,i-s.offsetWidth),e=Math.min(e,h-s.offsetHeight),t=Math.max(a,t),e=Math.max(o,e)}return{clientX:t,clientY:e}}function p(t,e,n){t&&(t.attachEvent?t.attachEvent("on"+e,n):t.addEventListener?t.addEventListener(e,n,!0):t["on"+e]=n)}function l(t,e,n){t&&(t.detachEvent?t.detachEvent("on"+e,n):t.removeEventListener?t.removeEventListener(e,n,!0):t["on"+e]=null)}var u=function(){},d=e;if("undefined"==typeof window)var f=!1;else{var f="ontouchstart"in window||"onmsgesturechange"in window;try{document.createEvent("TouchEvent")}catch(g){f=!1}}var y=function(){var t={touch:{start:"touchstart",move:"touchmove",end:"touchend"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"}};return t[f?"touch":"mouse"]}(),v=t.createClass({displayName:"Draggable",propTypes:{axis:t.PropTypes.oneOf(["both","x","y"]),handle:t.PropTypes.string,cancel:t.PropTypes.string,grid:t.PropTypes.arrayOf(t.PropTypes.number),start:t.PropTypes.object,onStart:t.PropTypes.func,onDrag:t.PropTypes.func,onStop:t.PropTypes.func,onMouseDown:t.PropTypes.func,bound:t.PropTypes.any},componentWillUnmount:function(){l(window,y.move,this.handleDrag),l(window,y.end,this.handleDragEnd)},getDefaultProps:function(){return{axis:"both",handle:null,cancel:null,grid:null,bound:!1,start:{x:0,y:0},onStart:u,onDrag:u,onStop:u,onMouseDown:u}},getInitialState:function(){return{dragging:!1,startX:0,startY:0,offsetX:0,offsetY:0,clientX:this.props.start.x,clientY:this.props.start.y}},handleDragStart:function(t){this.props.onMouseDown(t);var e=this.getDOMNode();if(!(this.props.handle&&!i(t.target,this.props.handle)||this.props.cancel&&i(t.target,this.props.cancel))){var s=h(t);this.setState({dragging:!0,offsetX:parseInt(s.clientX,10),offsetY:parseInt(s.clientY,10),startX:parseInt(e.style.left,10)||0,startY:parseInt(e.style.top,10)||0}),this.props.onStart(t,n(this)),p(window,y.move,this.handleDrag),p(window,y.end,this.handleDragEnd)}},handleDragEnd:function(t){this.state.dragging&&(this.setState({dragging:!1}),this.props.onStop(t,n(this)),l(window,y.move,this.handleDrag),l(window,y.end,this.handleDragEnd))},handleDrag:function(t){var e=h(t),s=this.state.startX+(e.clientX-this.state.offsetX),r=this.state.startY+(e.clientY-this.state.offsetY),o=c(s,r,this.props.bound,this.getDOMNode());if(s=o.clientX,r=o.clientY,Array.isArray(this.props.grid)){var a=s<parseInt(this.state.clientX,10)?-1:1,i=r<parseInt(this.state.clientY,10)?-1:1;s=Math.abs(s-parseInt(this.state.clientX,10))>=this.props.grid[0]?parseInt(this.state.clientX,10)+this.props.grid[0]*a:this.state.clientX,r=Math.abs(r-parseInt(this.state.clientY,10))>=this.props.grid[1]?parseInt(this.state.clientY,10)+this.props.grid[1]*i:this.state.clientY}this.setState({clientX:s,clientY:r}),this.props.onDrag(t,n(this)),t.preventDefault()},render:function(){var e={top:s(this)?this.state.clientY:this.state.startY,left:r(this)?this.state.clientX:this.state.startX},n=d({"react-drag":!0,"react-drag-dragging":this.state.dragging});return t.addons.cloneWithProps(t.Children.only(this.props.children),{style:e,className:n,onMouseDown:this.handleDragStart,onTouchStart:function(t){return t.preventDefault(),this.handleDragStart.apply(this,arguments)}.bind(this),onMouseUp:this.handleDragEnd,onTouchEnd:this.handleDragEnd})}});return v});